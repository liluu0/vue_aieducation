{"ast":null,"code":"import { Message } from 'element3';\nimport { ref, reactive, toRefs } from \"vue\";\nimport { reqTitle, reqUpload, reqtitle } from '@/api';\nexport default {\n  setup() {\n    const form = ref(null);\n    const ruleForm = reactive({\n      ruleForm: {\n        title: \"\",\n        image: '',\n        wImagehead: '',\n        detail: \"\",\n        wCost: '',\n        wPeople: \"\",\n        wTime: \"\",\n        wDay: \"\"\n      }\n    });\n    const rules = reactive({\n      rules: {\n        title: [{\n          required: true,\n          message: \"请输入文章标题\",\n          trigger: \"blur\"\n        }],\n        detail: [{\n          required: true,\n          message: \"请输入文章描述\",\n          trigger: \"blur\"\n        }, {\n          min: 1,\n          max: 500,\n          message: \"长度在 1 到 500 个字符\",\n          trigger: \"blur\"\n        }]\n      }\n    });\n    function submitForm() {\n      form.value.validate(async valid => {\n        if (valid) {\n          const data = {\n            wId: 1,\n            wTitle: ruleForm.ruleForm.title,\n            wImageback: ruleForm.ruleForm.image,\n            wImagehead: ruleForm.ruleForm.wImagehead,\n            wDetail: ruleForm.ruleForm.detail,\n            wCost: ruleForm.ruleForm.wCost,\n            wPeople: ruleForm.ruleForm.wPeople,\n            wTime: ruleForm.ruleForm.wTime,\n            wDay: ruleForm.ruleForm.wDay\n          };\n          try {\n            // 请求成功处理逻辑\n            await reqTitle(data).then(response => {\n              Message({\n                message: '上传成功',\n                type: 'success'\n              });\n            });\n          } catch (error) {\n            console.error('上传失败:', error);\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    }\n    function resetForm() {\n      form.value.resetFields();\n    }\n\n    //背景图片\n    const imageFileBack = ref(null);\n    const imageFileHead = ref(null);\n    const upload = async (imageFile, data) => {\n      try {\n        // 创建 FormData 对象\n        const formData = new FormData();\n\n        // 将图片文件添加到 FormData 对象中\n        formData.append(\"file\", imageFile.value);\n        const response = await reqUpload(formData);\n        Message({\n          message: '图片上传成功',\n          type: 'success'\n        });\n        if (data == 'image') {\n          ruleForm.ruleForm.image = response.data.data;\n        } else if (data == 'wImagehead') {\n          ruleForm.ruleForm.wImagehead = response.data.data;\n        }\n      } catch (error) {\n        Message.error('上传失败');\n        console.log(\"上传失败:\", error);\n        throw error;\n      }\n    };\n    const handleFileChange = event => {\n      imageFileBack.value = event.target.files[0];\n      upload(imageFileBack, 'image');\n    };\n    const handleImage = event => {\n      imageFileHead.value = event.target.files[0];\n      upload(imageFileHead, 'wImagehead');\n    };\n    return {\n      form,\n      ...toRefs(ruleForm),\n      ...toRefs(rules),\n      submitForm,\n      resetForm,\n      imageFileBack,\n      handleFileChange,\n      handleImage,\n      upload\n    };\n  },\n  async mounted() {\n    console.log(22);\n    try {\n      // 请求成功处理逻辑\n      const response = await reqtitle();\n      // console.log(response.data);\n      const {\n        wtitle,\n        wdetail,\n        wday,\n        wtime,\n        wcost,\n        wpeople\n      } = response.data.data[0];\n      // console.log(this.ruleForm);\n      this.ruleForm.title = wtitle;\n      this.ruleForm.detail = wdetail;\n      this.ruleForm.wDay = wday;\n      this.ruleForm.wTime = wtime;\n      this.ruleForm.wCost = wcost;\n      this.ruleForm.wPeople = wpeople;\n      // console.log(this.ruleForm,wtitle);\n    } catch (error) {\n      console.error('Error fetching data:', error);\n    }\n  }\n};","map":{"version":3,"names":["Message","ref","reactive","toRefs","reqTitle","reqUpload","reqtitle","setup","form","ruleForm","title","image","wImagehead","detail","wCost","wPeople","wTime","wDay","rules","required","message","trigger","min","max","submitForm","value","validate","valid","data","wId","wTitle","wImageback","wDetail","then","response","type","error","console","log","resetForm","resetFields","imageFileBack","imageFileHead","upload","imageFile","formData","FormData","append","handleFileChange","event","target","files","handleImage","mounted","wtitle","wdetail","wday","wtime","wcost","wpeople"],"sources":["D:\\代码\\vscodeProjects\\AiEducation\\vue_aieducation\\src\\components\\CreateClass\\index.vue"],"sourcesContent":["<template>\r\n    <div class=\"box\">\r\n\t\t\t<div class=\"subNav\">\r\n\t\t\t\t新建话题\r\n\t\t\t</div>\r\n\t\t\t<div class=\"subPageMain\" style=\"padding: 0;\">\r\n\t\t\t\t<div class=\"editContainer fulscren\">\r\n\t\t\t\t\t\t<div class=\"edit_main\">\r\n\t\t\t\t\t\t\t<div class=\"het76\" style=\"display: none;\"></div>\r\n\t\t\t\t\t\t\t<div class=\"edit_target\" style=\"\">\r\n\t\t\t\t\t\t\t\t<span style=\"margin-top: 9px;\" class=\"fl\">发布给</span>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t<span style=\"margin-left:18px;margin-top: 9px;float: left;\" classid=\"92709281\">2022软件1班</span>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"edit_btn fr\" style=\"position: static;    margin-top: 5px;\"><div class=\"jb_btn jb_btn_92_disable fs14 fr addTopic\">发布</div></div>\r\n\t\t\t\t\t\t\t\t<!--20210817-->\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\t\t<!--标签管理-->\r\n\t\t\t\t\t\t\t\t<!-- 2021-8-17 -->\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<div class=\"tags-list mscroll fr\" id=\"label-tags-list\">\r\n\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<!--标签管理-->\r\n\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"edit_title\">\r\n\t\t\t\t\t\t\t\t<textarea type=\"text\" name=\"title\" placeholder=\"请输入标题\"></textarea>\r\n\t\t\t\t\t\t\t</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        <el-form\r\n        :model=\"ruleForm\"\r\n        :rules=\"rules\"\r\n        ref=\"form\"\r\n        label-width=\"100px\"\r\n        class=\"demo-ruleForm\"\r\n        >\r\n        <el-form-item label=\"文章标题\" prop=\"title\">\r\n            <el-input v-model=\"ruleForm.title\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"背景图片\" prop=\"image\">\r\n            <input type=\"file\" @change=\"handleFileChange\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"头像\" prop=\"wImagehead\">\r\n            <input type=\"file\" @change=\"handleImage\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"描述\" prop=\"detail\">\r\n            <el-input v-model=\"ruleForm.detail\"></el-input>\r\n        </el-form-item>\r\n    \r\n        <el-form-item label=\"天数\" prop=\"wDay\">\r\n            <el-input v-model=\"ruleForm.wDay\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"时间\" prop=\"wTime\">\r\n            <el-input v-model=\"ruleForm.wTime\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"人均\" prop=\"wCost\">\r\n            <el-input v-model=\"ruleForm.wCost\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"和谁\" prop=\"wPeople\">\r\n            <el-input v-model=\"ruleForm.wPeople\"></el-input>\r\n        </el-form-item>\r\n    \r\n        <el-form-item>\r\n            <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">保存</el-button>\r\n            <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\r\n        </el-form-item>\r\n        </el-form>\r\n\r\n    \r\n    </div>\r\n</template>\r\n  \r\n<script>\r\nimport { Message } from 'element3'\r\nimport { ref, reactive, toRefs } from \"vue\";\r\nimport {reqTitle,reqUpload,reqtitle} from '@/api'\r\nexport default {\r\n    setup() {\r\n      const form = ref(null);\r\n      const ruleForm = reactive({\r\n        ruleForm: {\r\n          title: \"\",\r\n          image: '',\r\n          wImagehead:'',\r\n          detail: \"\",\r\n          wCost:'',\r\n          wPeople: \"\",\r\n          wTime: \"\",\r\n          wDay: \"\"\r\n        },\r\n      });\r\n      const rules = reactive({\r\n        rules: {\r\n          title: [{ required: true, message: \"请输入文章标题\", trigger: \"blur\" }],\r\n          detail: [\r\n            { required: true, message: \"请输入文章描述\", trigger: \"blur\" },\r\n            {\r\n              min: 1,\r\n              max: 500,\r\n              message: \"长度在 1 到 500 个字符\",\r\n              trigger: \"blur\",\r\n            },\r\n          ],\r\n        },\r\n      });\r\n      function submitForm() {\r\n        form.value.validate(async (valid) => {\r\n          if (valid) {\r\n              const data = {\r\n                        wId:1,\r\n                        wTitle:ruleForm.ruleForm.title,\r\n                        wImageback:ruleForm.ruleForm.image,\r\n                        wImagehead:ruleForm.ruleForm.wImagehead,\r\n                        wDetail:ruleForm.ruleForm.detail,\r\n                        wCost: ruleForm.ruleForm.wCost,\r\n                        wPeople: ruleForm.ruleForm.wPeople,\r\n                        wTime: ruleForm.ruleForm.wTime,\r\n                        wDay: ruleForm.ruleForm.wDay\r\n                      }\r\n        try {    \r\n            // 请求成功处理逻辑\r\n            await reqTitle(data).then(response => {\r\n              Message({\r\n              message: '上传成功',\r\n              type: 'success'})\r\n              \r\n            })\r\n        } catch (error) {\r\n          console.error('上传失败:', error);\r\n        }\r\n  \r\n          } else {\r\n            console.log(\"error submit!!\");\r\n            return false;\r\n          }\r\n        });\r\n      }\r\n      function resetForm() {\r\n        form.value.resetFields();\r\n      }\r\n  \r\n      //背景图片\r\n      const imageFileBack = ref(null);\r\n      const imageFileHead = ref(null);\r\n  \r\n      const upload = async (imageFile,data) => {\r\n        try {\r\n          // 创建 FormData 对象\r\n          const formData = new FormData();\r\n  \r\n          // 将图片文件添加到 FormData 对象中\r\n          formData.append(\"file\", imageFile.value);\r\n          const response = await reqUpload(formData)\r\n  \r\n  \r\n  \r\n            Message({\r\n              message: '图片上传成功',\r\n              type: 'success'\r\n            })\r\n            if(data=='image'){\r\n              ruleForm.ruleForm.image = response.data.data\r\n            }else  if(data=='wImagehead'){\r\n              ruleForm.ruleForm.wImagehead = response.data.data\r\n            }\r\n        } catch (error) {\r\n            Message.error('上传失败')\r\n            console.log(\"上传失败:\", error);\r\n            throw error;\r\n          }\r\n      };\r\n      const handleFileChange = (event) => {\r\n        imageFileBack.value = event.target.files[0];\r\n        upload(imageFileBack,'image');\r\n      };   \r\n      \r\n      const handleImage = (event ) => {\r\n        imageFileHead.value = event.target.files[0];\r\n        upload(imageFileHead,'wImagehead');\r\n      };\r\n  \r\n      return {\r\n        form,\r\n        ...toRefs(ruleForm),\r\n        ...toRefs(rules),\r\n        submitForm,\r\n        resetForm,\r\n  \r\n        imageFileBack,\r\n        handleFileChange,\r\n        handleImage,\r\n        upload,\r\n      };\r\n    },\r\nasync mounted() {\r\n      console.log(22);\r\n            try {    \r\n                   // 请求成功处理逻辑\r\n                  const response = await reqtitle()\r\n                  // console.log(response.data);\r\n                  const {wtitle,wdetail,wday,wtime,wcost,wpeople} = response.data.data[0]\r\n                  // console.log(this.ruleForm);\r\n                  this.ruleForm.title = wtitle\r\n                  this.ruleForm.detail = wdetail\r\n                  this.ruleForm.wDay = wday\r\n                  this.ruleForm.wTime = wtime\r\n                  this.ruleForm.wCost = wcost\r\n                  this.ruleForm.wPeople = wpeople\r\n                  // console.log(this.ruleForm,wtitle);\r\n  \r\n        } catch (error) {\r\n          console.error('Error fetching data:', error);\r\n        }\r\n    }\r\n  };\r\n</script>\r\n  \r\n<style scoped>\r\n.box {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: relative;\r\n}\r\n.subNav {\r\n    width: 100%;\r\n    height: 40px;\r\n    background: #3A4357;\r\n    box-shadow: 0 2px 17px 0 rgba(211,211,211,0.50);\r\n    text-align: center;\r\n    line-height: 40px;\r\n    font-size: 16px;\r\n    color: #A8A8B3;\r\n    position: fixed;\r\n    left: 0;\r\n    top: 0;\r\n    z-index: 2;\r\n}\r\n.subPageMain {\r\n    position: relative;\r\n    top: 40px;\r\n    width: 1200px;\r\n    min-height: 600px;\r\n    margin: 0 auto;\r\n    margin-top: 30px;\r\n    margin-bottom: 30px;\r\n    background: #FFFFFF;\r\n    box-shadow: 0 2px 17px 0 rgba(239, 239, 239, 0.5);\r\n    border-radius: 8px;\r\n}\r\n.editContainer.fulscren {\r\n    width: 100%;\r\n    height: 100%;\r\n    padding: 0;\r\n    margin: 0;\r\n    box-shadow: none;\r\n}\r\n</style>"],"mappings":"AAiFA,SAASA,OAAM,QAAS,UAAS;AACjC,SAASC,GAAG,EAAEC,QAAQ,EAAEC,MAAK,QAAS,KAAK;AAC3C,SAAQC,QAAQ,EAACC,SAAS,EAACC,QAAQ,QAAO,OAAM;AAChD,eAAe;EACXC,KAAKA,CAAA,EAAG;IACN,MAAMC,IAAG,GAAIP,GAAG,CAAC,IAAI,CAAC;IACtB,MAAMQ,QAAO,GAAIP,QAAQ,CAAC;MACxBO,QAAQ,EAAE;QACRC,KAAK,EAAE,EAAE;QACTC,KAAK,EAAE,EAAE;QACTC,UAAU,EAAC,EAAE;QACbC,MAAM,EAAE,EAAE;QACVC,KAAK,EAAC,EAAE;QACRC,OAAO,EAAE,EAAE;QACXC,KAAK,EAAE,EAAE;QACTC,IAAI,EAAE;MACR;IACF,CAAC,CAAC;IACF,MAAMC,KAAI,GAAIhB,QAAQ,CAAC;MACrBgB,KAAK,EAAE;QACLR,KAAK,EAAE,CAAC;UAAES,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,SAAS;UAAEC,OAAO,EAAE;QAAO,CAAC,CAAC;QAChER,MAAM,EAAE,CACN;UAAEM,QAAQ,EAAE,IAAI;UAAEC,OAAO,EAAE,SAAS;UAAEC,OAAO,EAAE;QAAO,CAAC,EACvD;UACEC,GAAG,EAAE,CAAC;UACNC,GAAG,EAAE,GAAG;UACRH,OAAO,EAAE,iBAAiB;UAC1BC,OAAO,EAAE;QACX,CAAC;MAEL;IACF,CAAC,CAAC;IACF,SAASG,UAAUA,CAAA,EAAG;MACpBhB,IAAI,CAACiB,KAAK,CAACC,QAAQ,CAAC,MAAOC,KAAK,IAAK;QACnC,IAAIA,KAAK,EAAE;UACP,MAAMC,IAAG,GAAI;YACHC,GAAG,EAAC,CAAC;YACLC,MAAM,EAACrB,QAAQ,CAACA,QAAQ,CAACC,KAAK;YAC9BqB,UAAU,EAACtB,QAAQ,CAACA,QAAQ,CAACE,KAAK;YAClCC,UAAU,EAACH,QAAQ,CAACA,QAAQ,CAACG,UAAU;YACvCoB,OAAO,EAACvB,QAAQ,CAACA,QAAQ,CAACI,MAAM;YAChCC,KAAK,EAAEL,QAAQ,CAACA,QAAQ,CAACK,KAAK;YAC9BC,OAAO,EAAEN,QAAQ,CAACA,QAAQ,CAACM,OAAO;YAClCC,KAAK,EAAEP,QAAQ,CAACA,QAAQ,CAACO,KAAK;YAC9BC,IAAI,EAAER,QAAQ,CAACA,QAAQ,CAACQ;UAC1B;UACd,IAAI;YACA;YACA,MAAMb,QAAQ,CAACwB,IAAI,CAAC,CAACK,IAAI,CAACC,QAAO,IAAK;cACpClC,OAAO,CAAC;gBACRoB,OAAO,EAAE,MAAM;gBACfe,IAAI,EAAE;cAAS,CAAC;YAElB,CAAC;UACL,EAAE,OAAOC,KAAK,EAAE;YACdC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK,CAAC;UAC/B;QAEE,OAAO;UACLC,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;UAC7B,OAAO,KAAK;QACd;MACF,CAAC,CAAC;IACJ;IACA,SAASC,SAASA,CAAA,EAAG;MACnB/B,IAAI,CAACiB,KAAK,CAACe,WAAW,CAAC,CAAC;IAC1B;;IAEA;IACA,MAAMC,aAAY,GAAIxC,GAAG,CAAC,IAAI,CAAC;IAC/B,MAAMyC,aAAY,GAAIzC,GAAG,CAAC,IAAI,CAAC;IAE/B,MAAM0C,MAAK,GAAI,MAAAA,CAAOC,SAAS,EAAChB,IAAI,KAAK;MACvC,IAAI;QACF;QACA,MAAMiB,QAAO,GAAI,IAAIC,QAAQ,CAAC,CAAC;;QAE/B;QACAD,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAEH,SAAS,CAACnB,KAAK,CAAC;QACxC,MAAMS,QAAO,GAAI,MAAM7B,SAAS,CAACwC,QAAQ;QAIvC7C,OAAO,CAAC;UACNoB,OAAO,EAAE,QAAQ;UACjBe,IAAI,EAAE;QACR,CAAC;QACD,IAAGP,IAAI,IAAE,OAAO,EAAC;UACfnB,QAAQ,CAACA,QAAQ,CAACE,KAAI,GAAIuB,QAAQ,CAACN,IAAI,CAACA,IAAG;QAC7C,CAAC,MAAM,IAAGA,IAAI,IAAE,YAAY,EAAC;UAC3BnB,QAAQ,CAACA,QAAQ,CAACG,UAAS,GAAIsB,QAAQ,CAACN,IAAI,CAACA,IAAG;QAClD;MACJ,EAAE,OAAOQ,KAAK,EAAE;QACZpC,OAAO,CAACoC,KAAK,CAAC,MAAM;QACpBC,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEF,KAAK,CAAC;QAC3B,MAAMA,KAAK;MACb;IACJ,CAAC;IACD,MAAMY,gBAAe,GAAKC,KAAK,IAAK;MAClCR,aAAa,CAAChB,KAAI,GAAIwB,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAC3CR,MAAM,CAACF,aAAa,EAAC,OAAO,CAAC;IAC/B,CAAC;IAED,MAAMW,WAAU,GAAKH,KAAI,IAAO;MAC9BP,aAAa,CAACjB,KAAI,GAAIwB,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;MAC3CR,MAAM,CAACD,aAAa,EAAC,YAAY,CAAC;IACpC,CAAC;IAED,OAAO;MACLlC,IAAI;MACJ,GAAGL,MAAM,CAACM,QAAQ,CAAC;MACnB,GAAGN,MAAM,CAACe,KAAK,CAAC;MAChBM,UAAU;MACVe,SAAS;MAETE,aAAa;MACbO,gBAAgB;MAChBI,WAAW;MACXT;IACF,CAAC;EACH,CAAC;EACL,MAAMU,OAAOA,CAAA,EAAG;IACVhB,OAAO,CAACC,GAAG,CAAC,EAAE,CAAC;IACT,IAAI;MACG;MACD,MAAMJ,QAAO,GAAI,MAAM5B,QAAQ,CAAC;MAChC;MACA,MAAM;QAACgD,MAAM;QAACC,OAAO;QAACC,IAAI;QAACC,KAAK;QAACC,KAAK;QAACC;MAAO,IAAIzB,QAAQ,CAACN,IAAI,CAACA,IAAI,CAAC,CAAC;MACtE;MACA,IAAI,CAACnB,QAAQ,CAACC,KAAI,GAAI4C,MAAK;MAC3B,IAAI,CAAC7C,QAAQ,CAACI,MAAK,GAAI0C,OAAM;MAC7B,IAAI,CAAC9C,QAAQ,CAACQ,IAAG,GAAIuC,IAAG;MACxB,IAAI,CAAC/C,QAAQ,CAACO,KAAI,GAAIyC,KAAI;MAC1B,IAAI,CAAChD,QAAQ,CAACK,KAAI,GAAI4C,KAAI;MAC1B,IAAI,CAACjD,QAAQ,CAACM,OAAM,GAAI4C,OAAM;MAC9B;IAEV,EAAE,OAAOvB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;IAC9C;EACJ;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}